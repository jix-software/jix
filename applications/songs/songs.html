<!DOCTYPE HTML>
<html>
<head>
  <!-- songs.js
       Copyright (C) Henri Lesourd 2019. -->
  <title>Songs</title>
  <meta charset="utf8">
  <link rel="stylesheet" href="songs.css" type="text/css" media="screen">
  <script src="jixweb.js"></script>
  <script language=javascript>
    installOnload(function () {
      var SRV=jix.server("http://localhost:8081/app.jix");

      SRV.containers(1);
      var C=server.SRV[0].container("PopMusic");
      song=type(Nil,{ NAME:"song" }); // FIXME: find a way to automatically download the types

      var SK=skin({ $:[
        [shape,
          { class:"song",
            mode:"view"
          },
          [view,{ mode:"short" }, "$Title", "\u00A0(", "$Year", "),\u00A0", "$Length", "."],
          [view,{ mode:"view" },
                [{ targets:"mode:$", class:"c1" },
                 [lines,
                  { class:"c2" },
                  [{},
                   [{ style:"font-style: italic;" },
                    "$Title"
                   ],
                   "\u00A0(", "$Genre", ")"
                  ],
                  [{}, "$Genre", "\u00A0(", "$Year", ")"],
                  [{}, "$Length"],
                  [button,{ class: "c5", title:"EDIT",
                            events:"click=>mode!edit" }]
                 ],
                 [{ style:"width: 2px" },
                  ""
                 ],
                 [splitv,
                  { class:"c3" },
                  "$Authors"
                 ]
                ]
          ],
          [view,{ mode:"edit" },
                [lines,
                 { targets:"save:$" },
                 [input,{ class: "c4", name:"Title" },"$Title"],
                 [input,{ class: "c4", name:"Year" },"$Year"],
                 [input,{ class: "c4", name:"Length" },"$Length"],
                 [button,{ class: "c5", title:"SAVE",
                           events:"click=>save&mode!view" }]
                ]
          ]
        ]
      ]});

      var L=markup(
        [table,{ cellspacing:"0", border:"0", width:"100%" },
          [tr,{},[td,{},
            [columns,{ targets:"load:#L1!*" },
              [lines,{},
                [input,{ class: "c4", name:"Title" },"*"],
                [input,{ class: "c4", name:"Year" },"*9"]
              ],
              [button,{ class: "c5", title:"OK",
                        events:"click => load" }]
            ]
          ]],
          [tr,{},[td,{},
            [div,{ style:"width: 100%; height: 75vh; overflow-y: scroll;" },
              [lines,{ id:"L1", src:C, value:query({ Year:"*5" }), skin:SK }]
            ]
          ]]
        ]
      );

      out(L);
    });
  </script>
</head>
<body class="c0">
</body>
</html>
